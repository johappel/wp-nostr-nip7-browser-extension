<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WP Nostr Signer</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <main class="popup">
    <h1>WP Nostr Signer</h1>

    <section class="profile-section">
      <div class="section-head">
        <h2>Öffentliches Nostr-Profil</h2>
        <button id="refresh-user" class="btn-secondary" type="button">Neu laden</button>
      </div>
      <div id="profile-card" class="wp-user-card">
        <p class="empty">Profil wird geladen...</p>
      </div>
      <div class="section-head">
        <button id="publish-profile" class="btn-primary" type="button">Profil an Nostr senden</button>
      </div>
      <p id="profile-hint" class="hint"></p>
    </section>

    <label class="row">
      <input type="checkbox" id="prefer-lock" />
      <span>WP-Nostr-Lock bevorzugen</span>
    </label>

    <p class="hint">
      Wenn aktiv, versucht die Extension, <code>window.nostr</code> gegen Überschreiben
      durch andere Extensions zu schützen.
    </p>

    <p class="hint warn">Änderung wirkt nach Tab-Reload.</p>

    <section class="unlock-section">
      <div class="section-head">
        <h2>ReLogin für sensible Aktionen</h2>
      </div>
      <div class="relogin-row">
        <span class="relogin-duration">15 Minuten</span>
        <span id="unlock-cache-state" class="state-pill state-inactive">inaktiv</span>
      </div>
      <p id="unlock-cache-hint" class="hint"></p>
      <p class="hint">Gilt für Signieren sowie Schlüssel sichern/wiederherstellen.</p>
    </section>

    <section class="backup-section">
      <div class="section-head">
        <h2>Nostr-Schlüssel</h2>
      </div>
      <div id="protection-row"></div>

      <div class="key-row key-row-export">
        <button id="export-key" class="btn-secondary" type="button">Exportieren</button>
        <input id="backup-output" class="backup-output" type="text" readonly placeholder="nsec1... (Export)" />
        <button id="backup-output-copy" class="btn-copy" type="button">Kopieren</button>
        <button id="backup-download" class="btn-secondary" type="button">⬇ Datei</button>
      </div>

      <div class="key-row key-row-import">
        <input id="import-nsec" type="text" placeholder="nsec1... (Import)" />
        <button id="import-key" class="btn-secondary" type="button">Importieren</button>
      </div>

      <div class="key-row key-row-create">
        <p class="hint warn compact-hint">Neue Schlüssel (Warnung: Identitätsverlust)</p>
        <button id="create-key" class="btn-danger" type="button">Erstellen</button>
      </div>

      <div class="cloud-backup">
        <div class="section-head">
          <h2>Schlüsselkopie in WordPress</h2>
        </div>
        <p id="cloud-backup-meta" class="hint">Status wird geladen...</p>
        <div class="backup-actions">
          <button id="backup-enable-cloud" class="btn-secondary" type="button">Speichern/Ersetzen</button>
          <button id="backup-restore-cloud" class="btn-secondary" type="button">Wiederherstellen</button>
          <button id="backup-delete-cloud" class="btn-danger" type="button">Löschen</button>
        </div>
      </div>
    </section>

    <section class="instance-section">
      <div class="section-head">
        <h2>Mitglieder-Instanz</h2>
      </div>
      <div id="instance-card" class="wp-user-card">
        <p class="empty">Instanz-Informationen werden geladen...</p>
      </div>
    </section>

    <p id="status" class="status"></p>
  </main>

  <script src="popup.js"></script>
</body>
</html>
